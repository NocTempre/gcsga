import { CharacterGURPS, LegacyCharacterGURPS, LootGURPS } from "@actor"
import { ActorType, ItemType, ModifierItem } from "@data"
import {
	ConditionGURPS,
	EffectGURPS,
	EquipmentContainerGURPS,
	EquipmentGURPS,
	EquipmentModifierContainerGURPS,
	EquipmentModifierGURPS,
	LegacyItemGURPS,
	// LegacyItemGURPS,
	MeleeWeaponGURPS,
	NoteContainerGURPS,
	NoteGURPS,
	RangedWeaponGURPS,
	RitualMagicSpellGURPS,
	SkillContainerGURPS,
	SkillGURPS,
	SpellContainerGURPS,
	SpellGURPS,
	TechniqueGURPS,
	TraitContainerGURPS,
	TraitGURPS,
	TraitModifierContainerGURPS,
	TraitModifierGURPS,
} from "@item"
import { JournalEntryPageGURPS, JournalEntryPagePDF } from "@module/journal-entry/page/document.ts"
import {
	AttributeGURPS,
	AttributeBonus,
	AttributePrereq,
	ConditionalModifierBonus,
	ContainedQuantityPrereq,
	ContainedWeightPrereq,
	ContainedWeightReduction,
	CostReduction,
	DRBonus,
	EquippedEquipmentPrereq,
	MoveBonus,
	MoveType,
	ReactionBonus,
	ResourceTracker,
	SkillBonus,
	SkillPointBonus,
	SkillPrereq,
	SpellBonus,
	SpellPointBonus,
	SpellPrereq,
	TraitPrereq,
	WeaponBonus,
	PrereqList,
} from "@system"
import { feature, prereq } from "@util"

const tokenHUDConditions = {
	crouching: "gurps.status.crouching",
	kneeling: "gurps.status.kneeling",
	sitting: "gurps.status.sitting",
	crawling: "gurps.status.crawling",
	prone: "gurps.status.prone",
	reeling: "gurps.status.reeling",
	fatigued: "gurps.status.fatigued",
	crippled: "gurps.status.crippled",
	bleeding: "gurps.status.bleeding",
	dead: "gurps.status.dead",
	shock: "gurps.status.shock",
	pain: "gurps.status.pain",
	unconscious: "gurps.status.unconscious",
	sleeping: "gurps.status.sleeping",
	comatose: "gurps.status.comatose",
	stun: "gurps.status.stun",
	"mental-stun": "gurps.status.mental-stun",
	poisoned: "gurps.status.poisoned",
	burning: "gurps.status.burning",
	cold: "gurps.status.cold",
	disarmed: "gurps.status.disarmed",
	falling: "gurps.status.falling",
	grappled: "gurps.status.grappled",
	restrained: "gurps.status.restrained",
	pinned: "gurps.status.pinned",
	sprinting: "gurps.status.sprinting",
	flying: "gurps.status.flying",
	stealthy: "gurps.status.stealthy",
	waiting: "gurps.status.waiting",
	invisible: "gurps.status.invisible",
	coughing: "gurps.status.coughing",
	retching: "gurps.status.retching",
	nausea: "gurps.status.nausea",
	agony: "gurps.status.agony",
	seizure: "gurps.status.seizure",
	blind: "gurps.status.blind",
	deafened: "gurps.status.deafened",
	silenced: "gurps.status.silenced",
	choking: "gurps.status.choking",
	"heart-attack": "gurps.status.heart-attack",
	euphoric: "gurps.status.euphoric",
	hallucinating: "gurps.status.hallucinating",
	drunk: "gurps.status.drunk",
	drowsy: "gurps.status.drowsy",
	dazed: "gurps.status.dazed",
}

const tokenHUDManeuvers = {
	"do-nothing": "gurps.maneuver.do-nothing",
	attack: "gurps.maneuver.attack",
	"all-out-attack": "gurps.maneuver.all-out-attack",
	"all-out-defense": "gurps.maneuver.all-out-defense",
	move: "gurps.maneuver.move",
	"move-and-attack": "gurps.maneuver.move-and-attack",
	"all-out-attack-double": "gurps.maneuver.all-out-attack-double",
	"all-out-defense-double": "gurps.maneuver.all-out-defense-double",
	"change-posture": "gurps.maneuver.change-posture",
	feint: "gurps.maneuver.feint",
	"all-out-attack-feint": "gurps.maneuver.all-out-attack-feint",
	"all-out-defense-dodge": "gurps.maneuver.all-out-defense-dodge",
	ready: "gurps.maneuver.ready",
	evaluate: "gurps.maneuver.evaluate",
	"all-out-attack-determined": "gurps.maneuver.all-out-attack-determined",
	"all-out-defense-parry": "gurps.maneuver.all-out-defense-parry",
	concentrate: "gurps.maneuver.concentrate",
	aim: "gurps.maneuver.aim",
	"all-out-attack-strong": "gurps.maneuver.all-out-attack-strong",
	"all-out-defense-block": "gurps.maneuver.all-out-defense-block",
	wait: "gurps.maneuver.wait",
	"blank-1": "gurps.maneuver.blank-1",
	"all-out-attack-suppressing-fire": "gurps.maneuver.all-out-attack-suppressing-fire",
	"blank-2": "gurps.maneuver.blank-2",
}

export const GURPSCONFIG = {
	skillDefaults: [] as SkillGURPS[],

	statusEffects: {
		conditions: tokenHUDConditions,
		maneuvers: tokenHUDManeuvers,
	},

	Actor: {
		documentClasses: {
			[ActorType.Character]: CharacterGURPS,
			[ActorType.LegacyCharacter]: LegacyCharacterGURPS,
			[ActorType.LegacyEnemy]: LegacyCharacterGURPS,
			[ActorType.Loot]: LootGURPS,
		},
		allowedContents: {
			[ActorType.Character]: [
				ItemType.Trait,
				ItemType.TraitContainer,
				ItemType.TraitModifier,
				ItemType.Skill,
				ItemType.Technique,
				ItemType.SkillContainer,
				ItemType.Spell,
				ItemType.RitualMagicSpell,
				ItemType.SpellContainer,
				ItemType.Equipment,
				ItemType.EquipmentContainer,
				ItemType.EquipmentModifier,
				ItemType.Note,
				ItemType.NoteContainer,
				ItemType.Effect,
				ItemType.Condition,
			],
			[ActorType.LegacyCharacter]: [ItemType.LegacyItem],
			[ActorType.LegacyEnemy]: [ItemType.LegacyItem],
			[ActorType.Loot]: [ItemType.Equipment, ItemType.EquipmentContainer],
		},
	},

	Item: {
		documentClasses: {
			[ItemType.Trait]: TraitGURPS,
			[ItemType.TraitContainer]: TraitContainerGURPS,
			[ItemType.TraitModifier]: TraitModifierGURPS,
			[ItemType.TraitModifierContainer]: TraitModifierContainerGURPS,
			[ItemType.Skill]: SkillGURPS,
			[ItemType.Technique]: TechniqueGURPS,
			[ItemType.SkillContainer]: SkillContainerGURPS,
			[ItemType.Spell]: SpellGURPS,
			[ItemType.RitualMagicSpell]: RitualMagicSpellGURPS,
			[ItemType.SpellContainer]: SpellContainerGURPS,
			[ItemType.Equipment]: EquipmentGURPS,
			[ItemType.EquipmentContainer]: EquipmentContainerGURPS,
			[ItemType.EquipmentModifier]: EquipmentModifierGURPS,
			[ItemType.EquipmentModifierContainer]: EquipmentModifierContainerGURPS,
			[ItemType.Note]: NoteGURPS,
			[ItemType.NoteContainer]: NoteContainerGURPS,
			[ItemType.LegacyItem]: LegacyItemGURPS,
			[ItemType.Effect]: EffectGURPS,
			[ItemType.Condition]: ConditionGURPS,
			[ItemType.WeaponMelee]: MeleeWeaponGURPS,
			[ItemType.WeaponRanged]: RangedWeaponGURPS,
		},
		allowedContents: {
			[ItemType.Trait]: [
				ItemType.TraitModifier,
				ItemType.TraitModifierContainer,
				ItemType.WeaponMelee,
				ItemType.WeaponRanged,
			],
			[ItemType.TraitContainer]: [
				ItemType.Trait,
				ItemType.TraitContainer,
				ItemType.TraitModifier,
				ItemType.TraitModifierContainer,
				ItemType.WeaponMelee,
				ItemType.WeaponRanged,
			],
			[ItemType.TraitModifier]: [],
			[ItemType.TraitModifierContainer]: [ItemType.TraitModifierContainer, ItemType.TraitModifier],
			[ItemType.Skill]: [ItemType.WeaponMelee, ItemType.WeaponRanged],
			[ItemType.Technique]: [ItemType.WeaponMelee, ItemType.WeaponRanged],
			[ItemType.SkillContainer]: [ItemType.Skill, ItemType.Technique, ItemType.SkillContainer],
			[ItemType.Spell]: [ItemType.WeaponMelee, ItemType.WeaponRanged],
			[ItemType.RitualMagicSpell]: [ItemType.WeaponMelee, ItemType.WeaponRanged],
			[ItemType.SpellContainer]: [ItemType.Spell, ItemType.RitualMagicSpell, ItemType.SpellContainer],
			[ItemType.Equipment]: [
				ItemType.EquipmentModifier,
				ItemType.EquipmentModifierContainer,
				ItemType.WeaponMelee,
				ItemType.WeaponRanged,
			],
			[ItemType.EquipmentContainer]: [
				ItemType.Equipment,
				ItemType.EquipmentContainer,
				ItemType.EquipmentModifier,
				ItemType.EquipmentModifierContainer,
				ItemType.WeaponMelee,
				ItemType.WeaponRanged,
			],
			[ItemType.EquipmentModifier]: [],
			[ItemType.EquipmentModifierContainer]: [ItemType.EquipmentModifier, ItemType.EquipmentModifierContainer],
			[ItemType.Note]: [],
			[ItemType.NoteContainer]: [ItemType.Note, ItemType.NoteContainer],
			[ItemType.LegacyItem]: [],
			[ItemType.Effect]: [],
			[ItemType.Condition]: [],
			[ItemType.WeaponMelee]: [],
			[ItemType.WeaponRanged]: [],
		} as Record<ItemType, ItemType[]>,
		childTypes: {
			[ItemType.Trait]: [],
			[ItemType.TraitContainer]: [ItemType.Trait, ItemType.TraitContainer],
			[ItemType.TraitModifier]: [],
			[ItemType.TraitModifierContainer]: [ItemType.TraitModifierContainer, ItemType.TraitModifier],
			[ItemType.Skill]: [],
			[ItemType.Technique]: [],
			[ItemType.SkillContainer]: [ItemType.Skill, ItemType.Technique, ItemType.SkillContainer],
			[ItemType.Spell]: [],
			[ItemType.RitualMagicSpell]: [],
			[ItemType.SpellContainer]: [ItemType.Spell, ItemType.RitualMagicSpell, ItemType.SpellContainer],
			[ItemType.Equipment]: [],
			[ItemType.EquipmentContainer]: [ItemType.Equipment, ItemType.EquipmentContainer],
			[ItemType.EquipmentModifier]: [],
			[ItemType.EquipmentModifierContainer]: [ItemType.EquipmentModifier, ItemType.EquipmentModifierContainer],
			[ItemType.Note]: [],
			[ItemType.NoteContainer]: [ItemType.Note, ItemType.NoteContainer],
			[ItemType.LegacyItem]: [],
			[ItemType.Effect]: [],
			[ItemType.Condition]: [],
			[ItemType.WeaponMelee]: [],
			[ItemType.WeaponRanged]: [],
		} as Record<ItemType, ItemType[]>,
	},

	Attribute: {
		classes: {
			attribute: AttributeGURPS,
			resourceTracker: ResourceTracker,
			moveType: MoveType,
		},
	},

	Feature: {
		classes: {
			[feature.Type.AttributeBonus]: AttributeBonus,
			[feature.Type.ConditionalModifierBonus]: ConditionalModifierBonus,
			[feature.Type.DRBonus]: DRBonus,
			[feature.Type.ReactionBonus]: ReactionBonus,
			[feature.Type.SkillBonus]: SkillBonus,
			[feature.Type.SkillPointBonus]: SkillPointBonus,
			[feature.Type.SpellBonus]: SpellBonus,
			[feature.Type.SpellPointBonus]: SpellPointBonus,
			[feature.Type.WeaponBonus]: WeaponBonus,
			[feature.Type.WeaponAccBonus]: WeaponBonus,
			[feature.Type.WeaponScopeAccBonus]: WeaponBonus,
			[feature.Type.WeaponDRDivisorBonus]: WeaponBonus,
			[feature.Type.WeaponMinSTBonus]: WeaponBonus,
			[feature.Type.WeaponMinReachBonus]: WeaponBonus,
			[feature.Type.WeaponMaxReachBonus]: WeaponBonus,
			[feature.Type.WeaponHalfDamageRangeBonus]: WeaponBonus,
			[feature.Type.WeaponMinRangeBonus]: WeaponBonus,
			[feature.Type.WeaponMaxRangeBonus]: WeaponBonus,
			[feature.Type.WeaponRecoilBonus]: WeaponBonus,
			[feature.Type.WeaponBulkBonus]: WeaponBonus,
			[feature.Type.WeaponParryBonus]: WeaponBonus,
			[feature.Type.WeaponBlockBonus]: WeaponBonus,
			[feature.Type.WeaponRofMode1ShotsBonus]: WeaponBonus,
			[feature.Type.WeaponRofMode1SecondaryBonus]: WeaponBonus,
			[feature.Type.WeaponRofMode2ShotsBonus]: WeaponBonus,
			[feature.Type.WeaponRofMode2SecondaryBonus]: WeaponBonus,
			[feature.Type.WeaponNonChamberShotsBonus]: WeaponBonus,
			[feature.Type.WeaponChamberShotsBonus]: WeaponBonus,
			[feature.Type.WeaponShotDurationBonus]: WeaponBonus,
			[feature.Type.WeaponReloadTimeBonus]: WeaponBonus,
			[feature.Type.WeaponSwitch]: WeaponBonus,
			[feature.Type.CostReduction]: CostReduction,
			[feature.Type.ContainedWeightReduction]: ContainedWeightReduction,
			[feature.Type.MoveBonus]: MoveBonus,
		},
	},

	Prereq: {
		classes: {
			[prereq.Type.List]: PrereqList,
			[prereq.Type.Trait]: TraitPrereq,
			[prereq.Type.Attribute]: AttributePrereq,
			[prereq.Type.ContainedQuantity]: ContainedQuantityPrereq,
			[prereq.Type.ContainedWeight]: ContainedWeightPrereq,
			[prereq.Type.EquippedEquipment]: EquippedEquipmentPrereq,
			[prereq.Type.Skill]: SkillPrereq,
			[prereq.Type.Spell]: SpellPrereq,
		},
	},

	JournalEntryPage: {
		documentClasses: {
			pdf: JournalEntryPagePDF,
			image: JournalEntryPageGURPS,
			text: JournalEntryPageGURPS,
			video: JournalEntryPageGURPS,
		},
	},

	select: {
		cr_level: {},
		cr_adj: {},
		study: {},
		study_level: {},
		attribute: {},
		progression: {},
		numeric_criteria: {},
		numeric_criteria_strict: {},
		string_criteria: {},
		has: {},
		all: {},
		tmcost: {},
		emcost: {},
		emweight: {},
		wsel: {},
		skillsel: {},
		spellcmp: {},
		spellmatch: {},
		stlimit: {},
		stdmg: {},
		movelimit: {},
		feature: {},
		feature_strict: {},
		prereq: {},
		prereq_strict: {},
		difficulty: {},
		container: {},
		affects: {},
		percentage: {},
		maneuvers: {},
		postures: {},
		display: {},
		length_units: {},
		weight_units: {},
		move_override: {},
		wswitch: {},
		wswitch_value: {},
		color: {},
		effect_action: {},
		conditions: {},
		duration_type: {},
	} as Record<string, Record<string, string>>,

	meleeMods: [] as ModifierItem[],
	rangedMods: [] as ModifierItem[],
	defenseMods: [] as ModifierItem[],
	commonMods: [] as { title: string; items: ModifierItem[]; open?: boolean }[],
	allMods: [] as ModifierItem[],
}
